@using ShikkhanobishMainWeb.Models
@using Flurl.Http
@using Microsoft.AspNetCore.Components;
@page "/{tID}"

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>MakeQuestion</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Responsive bootstrap 4 admin template" name="description" />
    <meta content="Coderthemes" name="author" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link href="~/css/makeQues.css" />
</head>

<body style="background-color:white">

    <!-- Begin page -->
    <!-- Start Page Content here -->
    <!-- ============================================================== -->



    <div class="content">

        <!-- Start container-fluid -->
        <div class="container-fluid">
            <!--row-->
            <div class="form-group row " >
                
                <div class="col-md-6 ">
                    <h3 style="color:darkmagenta">Teacher QuestionHistory</h3>
                </div>
                <div class="col-md-6" style="text-align:right">
                    <h2 style="color:crimson;font-family:Garamond; ">TeacherName</h2>
                </div>
            </div>
            <br />
            <br />

            <div class="form-group row">
                <div class="card-box widget-inline offset-5" style="background-color: #D2B4DE">
                    <div class="text-center p-3">
                        <h2 class="mt-2"style="color:white"> <b>@countTQH</b></h2>
                        <p class="" style="color:rebeccapurple">
                            Total Uploaded

                        </p>
                    </div>
                </div>
            </div>
            <!--end row -->

        </div>
        <br />
        <div class="col-12 " style="text-align:right">

            <a href="MakeQuestion" class="btn btn-outline-info">
                <i class="fas fa-marker "></i>
                <span> Make Question </span>
            </a>
        </div>
        <br />
        
        <div class="row">

            <div class="col-md-12">
                <div class="card-header">
                    <h5>TeacherQuestionHistory</h5>
                </div>
                <br />
                <br />
                <br />

                <br />


                @for (int m = 0; m < tqhList.Count; m++)
                {
                    for (int n = 0; n < questionList.Count; n++)
                    {
                        for (int k = 0; k < allClassList.Count; k++)
                        {
                            for (int p = 0; p < allSubject.Count; p++)
                            {
                                for (int q = 0; q < allChapter.Count; q++)
                                {
                                    if (tqhList[m].questionID == questionList[n].questionID && questionList[n].classID == allClassList[k].classID && questionList[n].subjectID==allSubject[p].subjectID &&  questionList[n].chapterID==allChapter[q].chapterID)
                                    {
            <div class="form-group row">
                <div class="col-md-12" >
                    <label class="" style="background-color: #7D3C98; color: white; border-radius: 30%; padding: 5px 12px; ">@allClassList[k].name</label>
                    <label class="" style="background-color: #CD6155; color: white; border-radius: 30%; padding: 5px 12px; ">@allSubject[p].name</label>
                    <label class="" style="background-color: #73C6B6; color: white; border-radius: 30%; padding: 5px 12px; ">@allChapter[q].name</label>

                </div>
                
            </div>


                                        <div class="form-group row">
                                            <div class="col-md-12">
                                                <h6 style="color:#7146FE"> Question</h6>
                                                <input type="text" class="form-control" style="height: 150px; width: 600px; background-color: #E9F7EF; color: black; font-size: 24px " @bind="@questionList[n].mainQuestion">
                                            </div>
                                        </div>
                                        <br />

                                        <div class="form-group row">
                                            <div class="col-md-6">
                                                <div class="col-4">
                                                    <h6 style="color:#7146FE">Option1:</h6>
                                                    <input type="text" class="form-control" style="width: 200px; height: 80px; text-align: center; background-color: #E9F7EF; color: black; font-size: 16px " @bind="@questionList[n].option1">
                                                </div>

                                            </div>
                                            <div class="col-md-6">
                                                <div class="col-4">
                                                    <h6 style="color:#7146FE">Option2:</h6>
                                                    <input type="text" class="form-control" style="width: 200px; height: 80px; text-align: center; background-color: #E9F7EF; color: black; font-size: 16px " @bind="@questionList[n].option2">
                                                </div>

                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-md-6">
                                                <div class="col-4">
                                                    <h6 style="color:#7146FE">Option3:</h6>
                                                    <input type="text" class="form-control" style="width: 200px; height: 80px; text-align: center; background-color: #E9F7EF; color: black; font-size: 16px "@bind="@questionList[n].option3">
                                                </div>

                                            </div>
                                            <div class="col-md-6">
                                                <div class="col-4">
                                                    <h6 style="color:#7146FE">Option4:</h6>
                                                    <input type="text" class="form-control" style="width: 200px; height: 80px; text-align: center; background-color: #E9F7EF; color: black; font-size: 16px " @bind="@questionList[n].option4">
                                                </div>
                                                
                                            </div>
                                        </div>
                                        <br />
                                        <hr />
                                        <hr />
                                        <br />
                                    }
                                }
                            }

                        }
                    }


                }
            </div>
        </div>
        <br />
        <br />
        <br />
        <!-- end container-fluid -->
        <!-- Footer Start -->
        <footer class="footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-12">
                        2021 &copy; shikkhanobish
                    </div>
                </div>
            </div>
        </footer>
        <!-- end Footer -->
    </div>
    <!-- end content -->
    <!-- END wrapper -->
    <!-- Vendor js -->

</body>
</html>

@code{
    [Parameter]
    public string tID { get; set; }

    int countTQH;
    List<TeacherQuesHistory> tqhList = new List<TeacherQuesHistory>();
    List<Question> questionList = new List<Question>();


    List<ClassInfo> allClassList = new List<ClassInfo>();
    List<Subject> allSubject = new List<Subject>();
    List<Chapter> allChapter = new List<Chapter>();

    protected override async Task OnInitializedAsync()
    {
        await GetTeacherQuestionHistory();
        await GetStudentCount();
        await GetClassSubChap();
    }

    public async Task GetTeacherQuestionHistory()
    {
        var thl = await "https://api.shikkhanobish.com/api/ShikkhanobishLogin/getTeacherQuestionHistory".GetJsonAsync<List<TeacherQuesHistory>>();

        for (int i= 0; i < thl.Count; i++)
        {
            if(thl[i].teacherID.ToString() == tID)
            {
                tqhList.Add(thl[i]);
            }
        }


        List<Question> ques = await "https://api.shikkhanobish.com/api/ShikkhanobishLogin/getQuestion".GetJsonAsync<List<Question>>();
        questionList = ques;
    }

    public async Task GetStudentCount()
    {

        int count = 0;
        var list = await "https://api.shikkhanobish.com/api/ShikkhanobishLogin/getTeacherQuestionHistory".GetJsonAsync<List<TeacherQuesHistory>>();
        for(int i = 0; i < list.Count; i++)
        {
            if (tID == list[i].teacherID.ToString())
            {
                count++;

            }
            countTQH = count;
        }
    }



    public async Task GetClassSubChap()
    {


        allClassList = await "https://api.shikkhanobish.com/api/ShikkhanobishLogin/getClassInfo".GetJsonAsync<List<ClassInfo>>();
        allSubject = await "https://api.shikkhanobish.com/api/ShikkhanobishLogin/getSubject".GetJsonAsync<List<Subject>>();
        allChapter = await "https://api.shikkhanobish.com/api/ShikkhanobishLogin/getChapter".GetJsonAsync<List<Chapter>>();


    }


}

